<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Additional Docstrings · ThreeBodyTB.jl Documentation</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../assets/nist-combined.css" rel="stylesheet" type="text/css"/>      <link rel="stylesheet" href="../assets/nist-combined.css"> <script src="../assets/jquery-1.9.0.min.js" type="text/javascript" defer="defer"></script><script src="../assets/nist-header-footer.js" type="text/javascript" defer="defer"></script><script async type="text/javascript" id="_fed_an_ua_tag" src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=NIST&subagency=github&pua=UA-66610693-1&yt=true&exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="ThreeBodyTB.jl Documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit">ThreeBodyTB.jl Documentation</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../ug_run/">Running Calculations</a></li><li><a class="tocitem" href="../ug_fit/">Fit Coefficients</a></li></ul></li><li><span class="tocitem">Core User Interface</span><ul><li><a class="tocitem" href="../structs/">Structs</a></li><li><a class="tocitem" href="../core/">Functions</a></li></ul></li><li class="is-active"><a class="tocitem" href>Additional Docstrings</a><ul class="internal"><li><a class="tocitem" href="#ThreeBodyTB"><span>ThreeBodyTB</span></a></li><li><a class="tocitem" href="#TB"><span>TB</span></a></li><li><a class="tocitem" href="#BandStruct"><span>BandStruct</span></a></li><li><a class="tocitem" href="#DOS"><span>DOS</span></a></li><li><a class="tocitem" href="#Atomdata"><span>Atomdata</span></a></li><li><a class="tocitem" href="#AtomicMod"><span>AtomicMod</span></a></li><li><a class="tocitem" href="#BandTools"><span>BandTools</span></a></li><li><a class="tocitem" href="#CalcTB"><span>CalcTB</span></a></li><li><a class="tocitem" href="#CrystalMod"><span>CrystalMod</span></a></li><li><a class="tocitem" href="#DFToutMod"><span>DFToutMod</span></a></li><li><a class="tocitem" href="#DFT"><span>DFT</span></a></li><li><a class="tocitem" href="#QE"><span>QE</span></a></li><li><a class="tocitem" href="#Ewald"><span>Ewald</span></a></li><li><a class="tocitem" href="#FitTB"><span>FitTB</span></a></li><li><a class="tocitem" href="#Force_Stress"><span>Force_Stress</span></a></li><li><a class="tocitem" href="#ManageDatabase"><span>ManageDatabase</span></a></li><li><a class="tocitem" href="#SCF"><span>SCF</span></a></li><li><a class="tocitem" href="#Utilty"><span>Utilty</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Additional Docstrings</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Additional Docstrings</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/master/docs/src/every.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h2 id="ThreeBodyTB"><a class="docs-heading-anchor" href="#ThreeBodyTB">ThreeBodyTB</a><a id="ThreeBodyTB-1"></a><a class="docs-heading-anchor-permalink" href="#ThreeBodyTB" title="Permalink"></a></h2><h2 id="TB"><a class="docs-heading-anchor" href="#TB">TB</a><a id="TB-1"></a><a class="docs-heading-anchor-permalink" href="#TB" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.tb_k" href="#ThreeBodyTB.TB.tb_k"><code>ThreeBodyTB.TB.tb_k</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">mutable struct tb_k{T}</code></pre><p>Tight binding object in k-space. Can be from direct import of DFT band structure using atomic proj, or from fft&#39;ed tb object. Similar to real-space version.</p><p><strong>Holds</strong></p><ul><li><code>Hk::Array{Complex{T},3}</code> Hamiltonian in k-space</li><li><code>K::Array{Float64,2}</code> K point array. In fractional coordinates of BZ.</li><li><code>kweights::Array{Float64,1}</code> K point weights.</li><li><code>k_dict::Dict</code> Dictionary from k-point like [0,0,0] to index.</li><li><code>nwan::Int64</code> Number of orbitals / generalized wannier functions.</li><li><code>nk::Int64</code> Number of k-points.</li><li><code>nonorth::Bool</code> </li><li><code>Sk::Array{Complex{T},3}</code> Overlap matrix.</li><li><code>scf::Bool</code> needs self-consistency?</li><li><code>h1::Array{T,2} #scf term</code> holds scf term if present</li><li><code>grid::Array{Int64,1}</code> dimensions of k-point grid, from regular grid like <code>[8,8,8]</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L171-L191">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.tb_crys_kspace" href="#ThreeBodyTB.TB.tb_crys_kspace"><code>ThreeBodyTB.TB.tb_crys_kspace</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">mutable struct tb_crys_kspace{T}</code></pre><p>Hold k-point tight binding and crystal structure. Similar to <code>tb_crys</code></p><p><strong>Holds</strong></p><ul><li><code>tb::tb_k</code></li><li><code>crys::crystal</code></li><li><code>nelec::Float64</code></li><li><code>dftenergy::Float64</code></li><li><code>scf::Bool</code></li><li><code>gamma::Array{T, 2}</code></li><li><code>eden::Array{Float64,1}</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L223-L236">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.read_tb_crys_kspace" href="#ThreeBodyTB.TB.read_tb_crys_kspace"><code>ThreeBodyTB.TB.read_tb_crys_kspace</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function read_tb_crys_kspace(filename; directory=missing)</code></pre><p>Reads and returns from <code>filename</code> a <code>tb_crys_kspace</code> object. See <code>write_tb_crys_kspace</code></p><p>If cannot find <code>&quot;filename&quot;</code>, will look for <code>&quot;filename.xml&quot;</code>, <code>&quot;filename.gz&quot;</code>, <code>&quot;filename.xml.gz&quot;</code></p><p>Can read gzipped files directly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L473-L483">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.write_tb_crys_kspace" href="#ThreeBodyTB.TB.write_tb_crys_kspace"><code>ThreeBodyTB.TB.write_tb_crys_kspace</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function write_tb_crys_kspace(filename, tbc::tb_crys_kspace)</code></pre><p>Save a <code>tb_crys_kspace</code> object to xml format. See <code>read_tb_crys_kspace</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L763-L767">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.make_tb_crys" href="#ThreeBodyTB.TB.make_tb_crys"><code>ThreeBodyTB.TB.make_tb_crys</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function make_tb_crys(ham::tb,crys::crystal, nelec::Float64, dftenergy::Float64; scf=false, eden = missing, gamma=missing, within_fit=true, screening=1.0, tb_energy=-999, fermi_energy=0.0 )</code></pre><p>Constructor function for <code>tb_crys</code> object</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L861-L865">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.make_tb_crys_kspace" href="#ThreeBodyTB.TB.make_tb_crys_kspace"><code>ThreeBodyTB.TB.make_tb_crys_kspace</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function make_tb_crys_kspace(hamk::tb_k,crys::crystal, nelec::Float64, dftenergy::Float64; scf=false, eden = missing, gamma=missing, screening=1.0)</code></pre><p>Constructor function for <code>tb_crys_kspace</code> object</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L891-L895">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.make_tb" href="#ThreeBodyTB.TB.make_tb"><code>ThreeBodyTB.TB.make_tb</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function make_tb(H, ind_arr, r_dict::Dict; h1=missing)</code></pre><p>Constructor function for <code>tb</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L916-L920">source</a></section><section><div><pre><code class="language-none">function make_tb(H, ind_arr, r_dict::Dict, S; h1=missing)</code></pre><p>Constructor function for <code>tb</code> with overlaps</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L948-L952">source</a></section><section><div><pre><code class="language-none">function make_tb(H, ind_arr, S; h1=missing)</code></pre><p>Constructor function for <code>tb</code>, better programming.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L1050-L1054">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.make_tb_k" href="#ThreeBodyTB.TB.make_tb_k"><code>ThreeBodyTB.TB.make_tb_k</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function make_tb_k(Hk, K, kweights, Sk; h1=missing, grid=[0,0,0], nonorth=true)</code></pre><p>Constructor for <code>tb_kspace</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L984-L988">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.load_hr_dat" href="#ThreeBodyTB.TB.load_hr_dat"><code>ThreeBodyTB.TB.load_hr_dat</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function load_hr_dat(filename, directory=&quot;&quot;)</code></pre><p>Load a wannier90 hr.dat file Not currently a major part of program, but you can use if you want.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L1088-L1092">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.calc_energy_fft" href="#ThreeBodyTB.TB.calc_energy_fft"><code>ThreeBodyTB.TB.calc_energy_fft</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function calc_energy_fft(tbc::tb_crys; grid=missing, smearing=0.01, return_more_info=false)</code></pre><p>Get energy using fft.</p><p>returns energy</p><p>if <code>return_more_info==true</code> then returns <code>etot, efermi, vals, vects</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L1573-L1583">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.calc_energy_charge_fft" href="#ThreeBodyTB.TB.calc_energy_charge_fft"><code>ThreeBodyTB.TB.calc_energy_charge_fft</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function calc_energy_charge_fft(tbc::tb_crys; grid=missing, smearing=0.01)</code></pre><p>Do fft, then calculate energy and charge.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L1907-L1911">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.calc_energy" href="#ThreeBodyTB.TB.calc_energy"><code>ThreeBodyTB.TB.calc_energy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function calc_energy(tbc::tb_crys; smearing=0.01, returnk=false)</code></pre><p>Calculate energy without fft.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L1997-L2001">source</a></section><section><div><pre><code class="language-none">function calc_energy(h::tb_crys, kgrid; smearing=0.01, returnk=false)</code></pre><p>Calculate energy no fft</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L2054-L2058">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.types_energy" href="#ThreeBodyTB.TB.types_energy"><code>ThreeBodyTB.TB.types_energy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function types_energy(tbc::tb_crys)</code></pre><p>Calculate the reference energy of each atom in crystal. This results in the  total energy being indexed to seperated non-spin-polarized atoms. This is arbirary.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L2012-L2017">source</a></section><section><div><pre><code class="language-none">function types_energy(tbc::tb_crys)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L2024-L2026">source</a></section><section><div><pre><code class="language-none">function types_energy(c::crystal)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L2033-L2035">source</a></section><section><div><pre><code class="language-none">function types_energy(types)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L2041-L2043">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.make_kgrid" href="#ThreeBodyTB.TB.make_kgrid"><code>ThreeBodyTB.TB.make_kgrid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function make_kgrid(kgrid)</code></pre><p>-<code>kgrid</code> is an array of 3 integers like <code>[8,8,8]</code> </p><p>returns regular MP Gamma-centered k-point grid and (equal) k-weights.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L2103-L2109">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.trim" href="#ThreeBodyTB.TB.trim"><code>ThreeBodyTB.TB.trim</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function trim(h::tb, tol=0.0002)</code></pre><p>Remove terms in <code>tb</code> with abs value smaller than <code>tol</code>. (Ryd) Will speed calculations at cost of accuracy. USE WITH CARE. Usually not necessary except for very large or very detailed calculations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L2146-L2152">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.organizedata" href="#ThreeBodyTB.TB.organizedata"><code>ThreeBodyTB.TB.organizedata</code></a> — <span class="docstring-category">Function</span></header><section><div><p>function organizedata(tbc::tb_crys)</p><p>Rearrange the data in the tbc as a function of distances for plotting purposes.</p><p><code>return data_onsite, data_arr</code></p><p>Returns two arrays. The first has data on the onsite elements.</p><ul><li>column 1 and 3 have atom indexes</li><li>column 2 and 4 have orbital numbers</li><li>columns 5 and 6 have real and imaginary parts of H</li><li>columns 11 and 12 have real and imaginary parts of S</li><li>column 7 has the closest inter-atomic distance</li><li>column 8 has the index of the closest atom.</li></ul><p>The second has intersite data</p><ul><li>column 1 and 3 have atom indexes for the atom pairs</li><li>column 2 and 4 have orbital numbers</li><li>columns 5 and 6 have real and imaginary parts of H</li><li>columns 11 and 12 have real and imaginary parts of S</li><li>column 7 has the inter-atomic distance</li><li>column 8,9,10 have the the direction cosines lmn for the atom pair.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L2231-L2256">source</a></section><section><div><pre><code class="language-none">function organizedata(crys::crystal, h::tb)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L2263-L2265">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.myfft_R_to_K" href="#ThreeBodyTB.TB.myfft_R_to_K"><code>ThreeBodyTB.TB.myfft_R_to_K</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function myfft_R_to_K(tbc, grid=missing)</code></pre><p>Does Fourier Transform R-&gt;k (fft) using FFTW for tb_crys</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L2381-L2385">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.myfft" href="#ThreeBodyTB.TB.myfft"><code>ThreeBodyTB.TB.myfft</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function myfft(crys, nonorth, grid, kpts,ham_kS, Sk=missing)</code></pre><p>Does Fourier Transform K-&gt;R (ifft) using FFTW.</p><p>Arguments</p><ul><li><code>crys</code> crystal</li><li><code>nonorth</code> nonorogonal bool</li><li><code>grid</code> k-point grid size</li><li><code>kpts</code> the k-points <code>nkpts</code>×<code>3</code> in the original order, to be rearranged into grid</li><li><code>ham_kS</code> hamiltonian in k space (<code>nw</code>×<code>nw</code>×<code>nkpts</code>)</li><li><code>Sk</code> overlaps in k space</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L2433-L2446">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.get_sym_R" href="#ThreeBodyTB.TB.get_sym_R"><code>ThreeBodyTB.TB.get_sym_R</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function get_sym_R(crys, grid, sss = 1.0)</code></pre><p>Figures out the r-space grid using Wigner-Seitz like construction to figure out the best arrangement of r-grid points to keep periodic copies closest to the original atom  and take into account symmetry.</p><p><code>return R_grid, R_int_grid, sym_R</code></p><p>returns the R_grid, the integer version, and the symmetry factor of each point.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L2552-L2563">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.tb_indexes" href="#ThreeBodyTB.TB.tb_indexes"><code>ThreeBodyTB.TB.tb_indexes</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function tb_indexes(d::dftout)</code></pre><p>Figures out mapping between DFT projected hamiltonian orbitals and crystal and the wannier orbitals we want.</p><p><code>return wan, semicore, nwan, nsemi, wan_atom, atom_wan</code></p><ul><li><code>wan</code> has the indexes of the wannier orbitals</li><li><code>semicore</code> has the indexes of semicore states.</li><li><code>nwan</code> number of wannier orbs</li><li><code>nsemi</code> number of semicore states</li><li><code>wan_atom</code> dictionary wannier to atom numbers</li><li><code>atom_wan</code> dictionary atom numbers to wannier orbitals</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L2703-L2716">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.find_vbm_cbm" href="#ThreeBodyTB.TB.find_vbm_cbm"><code>ThreeBodyTB.TB.find_vbm_cbm</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function find_vbm_cbm(eigs, fermi)</code></pre><p>Find the valence band max and conduction band minimum from eigs, relative to Fermi level.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L2798-L2802">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.ewald_energy" href="#ThreeBodyTB.TB.ewald_energy"><code>ThreeBodyTB.TB.ewald_energy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function ewald_energy(tbc::tb_crys, delta_q=missing)</code></pre><p>Return ewald energy term from tbc. If <code>delta_q</code>, the atomic charge density, is missing, loads from <code>tbc</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L2820-L2825">source</a></section><section><div><pre><code class="language-none">function ewald_energy(tbc::tb_crys_kspace, delta_q=missing)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L2839-L2841">source</a></section><section><div><pre><code class="language-none">function ewald_energy(crys::crystal, gamma, delta_q::Array{Float64,1})</code></pre><p>Does the actual calculation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L2855-L2859">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.get_dq" href="#ThreeBodyTB.TB.get_dq"><code>ThreeBodyTB.TB.get_dq</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function get_dq(tbc::tb_crys_kspace)</code></pre><p>Get atomic charge density from <code>tb_crys</code> or <code>tb_crys_kspace</code> or <code>crys + eden</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L2965-L2969">source</a></section><section><div><pre><code class="language-none">function get_dq(tbc::tb_crys)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L2974-L2976">source</a></section><section><div><pre><code class="language-none">function get_dq(crys::crystal, chargeden::Array{Float64,1})</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L2981-L2983">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.TB.get_energy_electron_density_kspace" href="#ThreeBodyTB.TB.get_energy_electron_density_kspace"><code>ThreeBodyTB.TB.get_energy_electron_density_kspace</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function get_energy_electron_density_kspace(tbcK::tb_crys_kspace; smearing = 0.01)</code></pre><p>Get energy / charge density from k-space tight binding object.</p><p><code>return bandenergy + etypes + echarge + energy_smear, eden, VECTS, VALS, error_flag</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L3100-L3107">source</a></section><section><div><pre><code class="language-none">function get_energy_electron_density_kspace(tb_k::tb_k, nelec; smearing = 0.01)</code></pre><p>K-space get energy and electron density from <code>tb_k</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/TB.jl#L3130-L3134">source</a></section></article><h2 id="BandStruct"><a class="docs-heading-anchor" href="#BandStruct">BandStruct</a><a id="BandStruct-1"></a><a class="docs-heading-anchor-permalink" href="#BandStruct" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.BandStruct.get_kpath" href="#ThreeBodyTB.BandStruct.get_kpath"><code>ThreeBodyTB.BandStruct.get_kpath</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function get_kpath(kpath=[0.5 0 0 ; 0 0 0; 0.5 0.5 0.5], names = missing, npts=30)</code></pre><p>Construct a k_path for a band structure calculations. Very simple.</p><ul><li><code>kpath</code> high symmetry k-points in fractional BZ coordinates.</li><li><code>names</code> names of kpoints like <code>[&quot;Γ&quot;, &quot;X&quot;]</code></li><li><code>npts</code> number of points between high-symmetry kpoints</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/BandStruct.jl#L181-L189">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.BandStruct.plot_bandstr-Tuple{Any}" href="#ThreeBodyTB.BandStruct.plot_bandstr-Tuple{Any}"><code>ThreeBodyTB.BandStruct.plot_bandstr</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function plot_bandstr(h::tb)</code></pre><p>Plots using <code>tb</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/BandStruct.jl#L230-L234">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.BandStruct.plot_bandstr-Tuple{ThreeBodyTB.TB.tb_crys}" href="#ThreeBodyTB.BandStruct.plot_bandstr-Tuple{ThreeBodyTB.TB.tb_crys}"><code>ThreeBodyTB.BandStruct.plot_bandstr</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function plot_bandstr(h::tb_crys; kpath, names = missing, proj_types=missing, proj_orbs = missing, proj_nums=missing)</code></pre><p>Plot the band structure of a <code>tb_crys</code> object. Can also perform a projected band structure if you specify at least one of <code>proj_types</code>, <code>proj_orbs</code>, <code>proj_nums</code>.</p><p>k-path specified by a kpath array and names.</p><p>Must do scf calculation before plotting.</p><p><strong>Arguments</strong></p><ul><li><code>h::tb_crys</code> - The tight-biding object we want to plot bands from. Only required argument.</li><li><code>kpath=[0.5 0 0 ; 0 0 0; 0.5 0.5 0.5; 0 0.5 0.5; 0 0 0 ;0 0 0.5]</code> - <code>nk</code> × 3 array k-point path (high symmetry points).</li><li><code>npts=30,</code> - number of points between high-symmetry k-points.</li><li><code>names=missing</code> - <code>nk</code> string array. Names of the high-symmetry k-points </li><li><code>proj_types=missing</code> - types to project onto. Either <code>proj_types=&quot;H&quot;</code> or <code>proj_types=[&quot;H&quot;, &quot;O&quot;]</code> are valid.</li><li><code>proj_orbs=missing</code> - orbitals to project onto. either <code>proj_orbs=:s</code> or <code>proj_orbs=[:s, :p]</code>.</li><li><code>proj_nums=missing</code> - atom numbers to project onto. Either <code>proj_nums=1</code> or <code>proj_nums=[1, 2]</code></li><li><code>efermi=missing</code> - allows you to specify fermi energy. Default is to take from <code>h</code></li><li><code>color=&quot;blue&quot;</code> - specify line color</li><li><code>MarkerSize=missing&quot;</code> - specify markersize</li><li><code>yrange=missing&quot;</code> - specify y-range. e.g. <code>yrange=[-0.7, 0.3]</code></li><li><code>plot_hk=false</code> - plot things besides the normal band structure. Can be one of <code>:Seig, :Heig, :Hreal, :Himag, :Sreal, :Simag</code> to plot H or S eigvals or components. Primarily for debugging.</li><li><code>align=&quot;vbm&quot;</code> - default or <code>&quot;valence&quot;</code> is to align valence band max to zero energy. Can also be <code>&quot;min&quot;</code>, which aligns on the minimum eigenvalue, or <code>&quot;fermi&quot;</code> or <code>&quot;ef&quot;</code>, which align on the Fermi level, </li><li><code>clear_pervious=true</code> - clears the plot before adding new stuff.</li><li><code>do_display=true</code> - display the plot. If <code>false</code>, can be used with display-less nodes. You can still use <code>savefig</code> from <code>Plots</code> to produce saved images.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/BandStruct.jl#L73-L98">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.BandStruct.plot_compare_dft-Tuple{Any,Any}" href="#ThreeBodyTB.BandStruct.plot_compare_dft-Tuple{Any,Any}"><code>ThreeBodyTB.BandStruct.plot_compare_dft</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function plot_compare_dft(tbc, bs; tbc2=missing)</code></pre><p>Plots a band structure comparison between a tight-binding crystal object (<code>tb_crys</code>) and a band structure directly from dft (either a <code>dftout</code> or <code>bs</code> object). </p><p>The k-points are fixed by the <code>bs</code> object.</p><p><code>tbc2</code> is an optional second <code>tbc_crys</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/BandStruct.jl#L465-L474">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.BandStruct.plot_compare_tb-Tuple{ThreeBodyTB.TB.tb,ThreeBodyTB.TB.tb}" href="#ThreeBodyTB.BandStruct.plot_compare_tb-Tuple{ThreeBodyTB.TB.tb,ThreeBodyTB.TB.tb}"><code>ThreeBodyTB.BandStruct.plot_compare_tb</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function plot_compare_tb(h1::tb, h2::tb; h3=missing)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/BandStruct.jl#L60-L62">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.BandStruct.plot_compare_tb-Tuple{ThreeBodyTB.TB.tb_crys,ThreeBodyTB.TB.tb_crys}" href="#ThreeBodyTB.BandStruct.plot_compare_tb-Tuple{ThreeBodyTB.TB.tb_crys,ThreeBodyTB.TB.tb_crys}"><code>ThreeBodyTB.BandStruct.plot_compare_tb</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function plot_compare_tb(h1::tb_crys, h2::tb_crys; h3=missing)</code></pre><p>Plot a comparison between different tight binding objects <code>h1</code>, <code>h2</code>, and optionally <code>h3</code>. Options similar to <code>plot_bandstr</code> but more limited.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/BandStruct.jl#L45-L50">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.BandStruct.setup_proj-NTuple{5,Any}" href="#ThreeBodyTB.BandStruct.setup_proj-NTuple{5,Any}"><code>ThreeBodyTB.BandStruct.setup_proj</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function setup_proj(crys, nwan, proj_types, proj_orbs, proj_nums)</code></pre><p>Figure out projection indexes</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/BandStruct.jl#L132-L136">source</a></section></article><h2 id="DOS"><a class="docs-heading-anchor" href="#DOS">DOS</a><a id="DOS-1"></a><a class="docs-heading-anchor-permalink" href="#DOS" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.DOS.dos-Tuple{ThreeBodyTB.TB.tb_crys}" href="#ThreeBodyTB.DOS.dos-Tuple{ThreeBodyTB.TB.tb_crys}"><code>ThreeBodyTB.DOS.dos</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function dos(tbc::tb_crys; grid=missing, npts=missing, proj_type=missing, do_display=true)</code></pre><p>DOS, using tetrahedral integration</p><ul><li><code>grid</code> is the k-point grid. Defaults to 1.6 times the default grid for energy integration.</li><li><code>npts</code> is number of energies</li><li><code>proj_type</code> can be <code>&quot;none&quot;</code>, <code>&quot;atomic&quot;</code>, or <code>&quot;orbital&quot;</code>. Defaults to <code>atomic</code> if more than one atom type.</li><li><code>do_display=false</code> will suppress plotting</li></ul><p><code>return energies, dos, projected_dos, pdos_names</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/DOS.jl#L506-L517">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.DOS.gaussian_dos-Tuple{ThreeBodyTB.TB.tb_crys}" href="#ThreeBodyTB.DOS.gaussian_dos-Tuple{ThreeBodyTB.TB.tb_crys}"><code>ThreeBodyTB.DOS.gaussian_dos</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function gaussian_dos(tbc::tb_crys; grid=missing, smearing=0.02, npts=missing, proj_type=missing, do_display=true)</code></pre><p>Simple Gaussian DOS, mostly for testing.</p><ul><li><code>npts</code> is number of energies</li><li><code>proj_type</code> can be <code>&quot;none&quot;</code>, <code>&quot;atomic&quot;</code>, or <code>&quot;orbital&quot;</code></li><li><code>do_display=false</code> will suppress the actual plot</li></ul><p>The combination of <code>smearing</code> and <code>grid</code> are important to get converged results.</p><p>See also <code>dos</code></p><p><code>return energies, dos, projected_dos, pdos_names</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/DOS.jl#L226-L240">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.DOS.plot_dos-NTuple{4,Any}" href="#ThreeBodyTB.DOS.plot_dos-NTuple{4,Any}"><code>ThreeBodyTB.DOS.plot_dos</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function plot_dos(energies, dos, pdos, names; filename=missing, do_display=true)</code></pre><p>Does the actual DOS plotting, called by <code>dos</code> or <code>gaussian_dos</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/DOS.jl#L802-L806">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.DOS.projection-Tuple{ThreeBodyTB.TB.tb_crys,Any,Any,Any}" href="#ThreeBodyTB.DOS.projection-Tuple{ThreeBodyTB.TB.tb_crys,Any,Any,Any}"><code>ThreeBodyTB.DOS.projection</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function projection(tbc::tb_crys, vects, sk3, grid; ptype=missing)</code></pre><p>Figures out the projections. <code>ptype</code> can be <code>:atomic</code> or <code>:orbs</code> for atom projection or orbital projection (:s,:p,:d) Default is to choose <code>:atomic</code> except for elemental systems.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/DOS.jl#L93-L99">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.DOS.setup_tetra-Tuple{Any}" href="#ThreeBodyTB.DOS.setup_tetra-Tuple{Any}"><code>ThreeBodyTB.DOS.setup_tetra</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function setup_tetra(grid)</code></pre><p>Setup simple tetrahedron method based on tetra.f90 in QE. Simple tetra method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/DOS.jl#L412-L418">source</a></section></article><h2 id="Atomdata"><a class="docs-heading-anchor" href="#Atomdata">Atomdata</a><a id="Atomdata-1"></a><a class="docs-heading-anchor-permalink" href="#Atomdata" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Atomdata" href="#ThreeBodyTB.Atomdata"><code>ThreeBodyTB.Atomdata</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia">module Atomdata</code></pre><p>Holds the data for isolated atoms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Atomdata.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Atomdata.atom_prefered_oxidation" href="#ThreeBodyTB.Atomdata.atom_prefered_oxidation"><code>ThreeBodyTB.Atomdata.atom_prefered_oxidation</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia">atom_prefered_oxidation::Dict()</code></pre><p>Prefered oxidation states of atoms, in descending order of preference (approximate).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Atomdata.jl#L256-L260">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Atomdata.atom_radius" href="#ThreeBodyTB.Atomdata.atom_radius"><code>ThreeBodyTB.Atomdata.atom_radius</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia">atom_radius::Dict()</code></pre><p>Atomic radius (metallic), in pm</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Atomdata.jl#L154-L158">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Atomdata.atoms" href="#ThreeBodyTB.Atomdata.atoms"><code>ThreeBodyTB.Atomdata.atoms</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia">atoms::Dict()</code></pre><p>Periodic table information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Atomdata.jl#L11-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Atomdata.cutoff_dist" href="#ThreeBodyTB.Atomdata.cutoff_dist"><code>ThreeBodyTB.Atomdata.cutoff_dist</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia">cutoff_dist::Dict()</code></pre><p>Cutoff distance for Hamiltonian calculation</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Atomdata.jl#L355-L359">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Atomdata.electronegativity" href="#ThreeBodyTB.Atomdata.electronegativity"><code>ThreeBodyTB.Atomdata.electronegativity</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia">electronegativity::Dict()</code></pre><p>Pauling scale.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Atomdata.jl#L578-L582">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Atomdata.min_dimer_dist_dict" href="#ThreeBodyTB.Atomdata.min_dimer_dist_dict"><code>ThreeBodyTB.Atomdata.min_dimer_dist_dict</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia">min_dimer_dist_dict::Dict()</code></pre><p>Approximate minimum distance in current fitting data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Atomdata.jl#L406-L410">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Atomdata.sub_list" href="#ThreeBodyTB.Atomdata.sub_list"><code>ThreeBodyTB.Atomdata.sub_list</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia">sub_list::Dict()</code></pre><p>Most likely substitution list, approximate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Atomdata.jl#L484-L488">source</a></section></article><h2 id="AtomicMod"><a class="docs-heading-anchor" href="#AtomicMod">AtomicMod</a><a id="AtomicMod-1"></a><a class="docs-heading-anchor-permalink" href="#AtomicMod" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.AtomicMod" href="#ThreeBodyTB.AtomicMod"><code>ThreeBodyTB.AtomicMod</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia">module AtomicMod</code></pre><p>Simple module for atom type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Atomic.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.AtomicMod.atom" href="#ThreeBodyTB.AtomicMod.atom"><code>ThreeBodyTB.AtomicMod.atom</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">struct atom</code></pre><p>Hold basic atomic information</p><ul><li><code>name::String</code> </li><li><code>Z::Int64</code> Atomic number</li><li><code>row::Float64</code> Periodic table row</li><li><code>col::Float64</code> Periodic table col</li><li><code>mass::Float64</code> Mass in amu </li><li><code>nval::Float64</code> Number of valence electrons in TB calculation.</li><li><code>nsemicore::Int64</code> Number of semicore electrons. Depends on pseudopotential choice</li><li><code>nwan::Int64</code> Number of TB orbitals</li><li><code>orbitals::Array{Symbol,1}</code> Names of the orbitals, like <code>[:s, :p]</code></li><li><code>total_energy::Float64</code> DFT total energy, depends on pseudopotentials.</li><li><code>eigs::Dict</code> orbital eigenvalues of isolated non-spin-polarized nuetral atom.</li><li><code>energy_offset::Float64</code> energy to add to TB calculation to make isolated atoms have zero energy.</li><li><code>U::Float64</code> U value for Ewald correction</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Atomic.jl#L12-L31">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.AtomicMod.makeatom" href="#ThreeBodyTB.AtomicMod.makeatom"><code>ThreeBodyTB.AtomicMod.makeatom</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function makeatom(name, Z, row, col, mass, nval, nsemicore, orbitals, etot, eigs, vac_potential=0.0, U=0.0)</code></pre><p>Constructor for atom.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Atomic.jl#L66-L70">source</a></section></article><h2 id="BandTools"><a class="docs-heading-anchor" href="#BandTools">BandTools</a><a id="BandTools-1"></a><a class="docs-heading-anchor-permalink" href="#BandTools" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.BandTools" href="#ThreeBodyTB.BandTools"><code>ThreeBodyTB.BandTools</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia">module BandTools</code></pre><p>Utility functions for manipulating band structures. These need to be defined early in the code so other Modules have acccess to them.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/BandTools.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.BandTools.band_energy" href="#ThreeBodyTB.BandTools.band_energy"><code>ThreeBodyTB.BandTools.band_energy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function band_energy(eigs, weights, nelec, smearing = 0.01; returnk=false, returnocc=false, returnef=false, returnboth=false)</code></pre><p>Calculate band energy. Has options for additional return variables. Calculates fermi energy internally.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/BandTools.jl#L73-L77">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.BandTools.calc_fermi" href="#ThreeBodyTB.BandTools.calc_fermi"><code>ThreeBodyTB.BandTools.calc_fermi</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function calc_fermi(eigs, weights, nelec, smearing = 0.01)</code></pre><p>calculate fermi energy using bisection</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/BandTools.jl#L20-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.BandTools.smearing_energy" href="#ThreeBodyTB.BandTools.smearing_energy"><code>ThreeBodyTB.BandTools.smearing_energy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function smearing_energy(eigs, weights, efermi, smearing = 0.01)</code></pre><p>Smearing contribution to total energy. If you don&#39;t take this int account in metals or  small gap semiconductors, your energy is not variational  in the correct way, and things like forces and stresses become wrong.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/BandTools.jl#L103-L109">source</a></section></article><h2 id="CalcTB"><a class="docs-heading-anchor" href="#CalcTB">CalcTB</a><a id="CalcTB-1"></a><a class="docs-heading-anchor-permalink" href="#CalcTB" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB" href="#ThreeBodyTB.CalcTB"><code>ThreeBodyTB.CalcTB</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia">module CalcTB</code></pre><p>Create TB matrix sets from coefficients, or prepare to fit the coefficients.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L7-L11">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.coefs" href="#ThreeBodyTB.CalcTB.coefs"><code>ThreeBodyTB.CalcTB.coefs</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">struct coefs</code></pre><p>Hold the TB coefficients for 2body or 3body interactions</p><ul><li><code>dim::Int64</code> - dimension (2 or 3)</li><li><code>datH::Array{Float64,1}</code> Hamiltonian parameters</li><li><code>datS::Array{Float64,1}</code>  Overlap parameters, if any</li><li><code>sizeH::Int64</code> </li><li><code>sizeS::Int64</code></li><li><code>inds::Dict{Array{Symbol}, Array{Int64,1}}</code> Holds inds that tell which coeffiecients correspond to which atoms/orbitals</li><li><code>names::Set</code> Names of atoms</li><li><code>orbs::Array{Any,1}</code> Orbitals </li><li><code>cutoff::Float64</code> cutoff distance</li><li><code>min_dist::Float64</code> minimum atom-atom distance in fitting data</li><li><code>maxmin_val_train::Dict</code> max and min value of matrix elements within fitting data</li><li><code>dist_frontier::Dict</code> dictionary of pareto frontier of shortest fitting distances</li><li><code>version::Int64</code> version number</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L92-L110">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.calc_frontier-Tuple{ThreeBodyTB.CrystalMod.crystal,Any}" href="#ThreeBodyTB.CalcTB.calc_frontier-Tuple{ThreeBodyTB.CrystalMod.crystal,Any}"><code>ThreeBodyTB.CalcTB.calc_frontier</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function calc_frontier(crys::crystal, frontier; var_type=Float64, test_frontier=false, diststuff=missing, verbose=true)</code></pre><p>Calculate a pareto frontier of short distances. For 2body interactions, this is just a single distance, which is easy. For 3body interactions, there are 3 distances, so multiple points are on the frontier. Useful for deciding if old fitting data applies to a new structure with atoms that are close together.</p><p><code>test_frontier=true</code> is used to check if new structure is in the frontier. othersise, see if new structure changes frontier.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L2424-L2434">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.calc_onsite" href="#ThreeBodyTB.CalcTB.calc_onsite"><code>ThreeBodyTB.CalcTB.calc_onsite</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function calc_onsite(t1,s1,s2, database=missing)</code></pre><p>Handles atomic matrix els. We do not currently fit onsite matrix els</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L3881-L3885">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.calc_tb_fast" href="#ThreeBodyTB.CalcTB.calc_tb_fast"><code>ThreeBodyTB.CalcTB.calc_tb_fast</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">calc_tb_fast(crys::crystal; database=missing, use_threebody=true, use_threebody_onsite=true)</code></pre><p>Construct <code>tb_crys</code> from crystal stucture, but does not solve. This is usually called internally by functions like <code>scf_energy</code>, but you can use it directly if you want. Until you do a SCF energy calculation, the electron density and Fermi level will be wrong.</p><p><strong>Arguments</strong></p><ul><li><code>crys::crystal</code> - Required crystal structure</li><li><code>database=missing</code> - Source of coefficients. Will load from default source if not specified.</li><li><code>use_threebody=true</code> - Use three-body off-site interactions. Only turn off for testing purposes.</li><li><code>use_threebody_onsite=true</code> - Use three-body on-site interactions. Only turn off for testing purposes.</li><li><code>verbose=true</code> - set to false for less output.</li><li><code>var_type=missing</code> - variable type of <code>tb_crys</code>. Default is <code>Float64</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L1960-L1975">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.calc_tb_prepare_fast-Tuple{ThreeBodyTB.TB.tb_crys}" href="#ThreeBodyTB.CalcTB.calc_tb_prepare_fast-Tuple{ThreeBodyTB.TB.tb_crys}"><code>ThreeBodyTB.CalcTB.calc_tb_prepare_fast</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function calc_tb_prepare_fast(reference_tbc::tb_crys; use_threebody=false, use_threebody_onsite=false)</code></pre><p>Take a <code>tbc</code> from DFT and rearrange it for use in fitting code. Basically set it up so that it is ready for a least squares linear fit of coefficients.</p><p><code>return twobody_arrays, threebody_arrays, hvec, svec, Rvec, INDvec, h_onsite, ind_conversion, dmin_types, dmin_types3</code></p><p>Where</p><ul><li><code>twobody_arrays</code> - info for fitting twobody coefficients</li><li><code>threebody_array</code> - info for fitting twobody coefficients</li><li><code>hvec</code> - vector of reference TB matrix els, arranged for fitting</li><li><code>svec</code> - vector of reference overlap matrix els, arranged for fitting</li><li><code>Rvec</code> - displaments</li><li><code>INDvec</code> info on which matrix el goes with which row</li><li><code>h_onsite</code> info for subtracting atomic terms, I think</li><li><code>ind_conversion</code> - dict to convert between place in hamiltonian and overall counter, which removes duplicates.</li><li><code>dmin_types</code> - shortest 2body distances</li><li><code>dmin_types</code> - shortest 3body distances</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L2909-L2928">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.calc_threebody-NTuple{13,Any}" href="#ThreeBodyTB.CalcTB.calc_threebody-NTuple{13,Any}"><code>ThreeBodyTB.CalcTB.calc_threebody</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function calc_threebody(c,ind, t1,t2,t3,orb1,orb2,dist,dist31,dist32,lmn12, lmn31,lmn32; database=missing, memory0=missing, memory1=missing, memory2=missing, memoryV=missing, precalc=false, set_maxmin=false)</code></pre><p>Calculate 3body intersite hamiltonian interactions.</p><p><code>memory1</code>, etc have preallocated memory. This function is important for performance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L4985-L4991">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.calc_threebody_onsite-NTuple{7,Any}" href="#ThreeBodyTB.CalcTB.calc_threebody_onsite-NTuple{7,Any}"><code>ThreeBodyTB.CalcTB.calc_threebody_onsite</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function calc_threebody_onsite(t1,t2,t3,orb1,dist12,dist13,dist23, database; set_maxmin=false, memory=missing)</code></pre><p>calculate threebody onsite interactions</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L4935-L4939">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.calc_twobody-NTuple{7,Any}" href="#ThreeBodyTB.CalcTB.calc_twobody-NTuple{7,Any}"><code>ThreeBodyTB.CalcTB.calc_twobody</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function calc_twobody(t1,t2,orb1,orb2,dist,lmn, database)</code></pre><p>Two body intersite Hamiltonian and overlap matrix els.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L4730-L4734">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.calc_twobody_onsite-NTuple{7,Any}" href="#ThreeBodyTB.CalcTB.calc_twobody_onsite-NTuple{7,Any}"><code>ThreeBodyTB.CalcTB.calc_twobody_onsite</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function calc_twobody_onsite(t1,t2,orb1,orb2, dist,lmn, database)</code></pre><p>Calculate 2body onsite interactions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L4856-L4860">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.distances_etc" href="#ThreeBodyTB.CalcTB.distances_etc"><code>ThreeBodyTB.CalcTB.distances_etc</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function distances_etc(crys, cutoff, cutoff2=missing)</code></pre><p>Old distance function, no threebody only twobody. Code primarly uses <code>distances_etc_3bdy_parallel</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L1221-L1226">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.distances_etc_3bdy_parallel" href="#ThreeBodyTB.CalcTB.distances_etc_3bdy_parallel"><code>ThreeBodyTB.CalcTB.distances_etc_3bdy_parallel</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function distances_etc_3bdy_parallel(crys, cutoff=missing, cutoff2=missing; var_type=Float64)</code></pre><p>Finds atoms-atom and atom-atom-atom distances that are less than the cutoffs.</p><p><code>return R_keep, R_keep_ab, array_ind3, array_floats3, dist_arr, c_zero, dmin_types, dmin_types3</code></p><p>Where</p><ul><li><code>R_keep</code> has the supercells that are necessary</li><li><code>R_keep_ab</code> has the 2body indexes that are less than the <code>cutoff</code></li><li><code>array_ind3</code> has the 3body indexes</li><li><code>array_floats3</code> has the 3body actual distances and lmn.</li><li><code>dist_arr</code> has the actual 2body distances</li><li><code>c_zero</code> the index of cell <code>[0,0,0]</code>, the onsite cell</li><li><code>dmin_types</code> minimum distance between types of atoms.</li><li><code>dmin_types3</code> minimum 3body distances between types of atoms.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L1301-L1319">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.fit_threebody-NTuple{11,Any}" href="#ThreeBodyTB.CalcTB.fit_threebody-NTuple{11,Any}"><code>ThreeBodyTB.CalcTB.fit_threebody</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function fit_threebody(t1,t2,t3,orb1,orb2,dist,dist31,dist32,lmn12, lmn31,lmn32)</code></pre><p>Fit threebody intersite interactions</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L5020-L5024">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.fit_threebody_onsite-NTuple{6,Any}" href="#ThreeBodyTB.CalcTB.fit_threebody_onsite-NTuple{6,Any}"><code>ThreeBodyTB.CalcTB.fit_threebody_onsite</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function fit_threebody_onsite(t1,t2,t3,orb1,dist12,dist13,dist23)</code></pre><p>Fit three body onsite interactions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L4962-L4966">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.fit_twobody-NTuple{4,Any}" href="#ThreeBodyTB.CalcTB.fit_twobody-NTuple{4,Any}"><code>ThreeBodyTB.CalcTB.fit_twobody</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function fit_twobody(orb1,orb2,dist,lmn)</code></pre><p>Fit Two body intersite Hamiltonian and overlap matrix els.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L4791-L4795">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.fit_twobody_onsite-NTuple{6,Any}" href="#ThreeBodyTB.CalcTB.fit_twobody_onsite-NTuple{6,Any}"><code>ThreeBodyTB.CalcTB.fit_twobody_onsite</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function fit_twobody_onsite(t1,t2,orb1,orb2, dist,lmn)</code></pre><p>Fit 2body onsite interactions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L4899-L4903">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.get_data_info_v1-Tuple{Any,Any}" href="#ThreeBodyTB.CalcTB.get_data_info_v1-Tuple{Any,Any}"><code>ThreeBodyTB.CalcTB.get_data_info_v1</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function get_data_info(at_set, dim)</code></pre><p>Figure out the arrangement of data in a <code>coefs</code> file.</p><p>Loops over various combinations of orbitals and atoms and assigns them places in <code>datH</code> and <code>datS</code>, depending on the terms included in the model and the dimensionaly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L871-L877">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.get_data_info_v2-Tuple{Any,Any}" href="#ThreeBodyTB.CalcTB.get_data_info_v2-Tuple{Any,Any}"><code>ThreeBodyTB.CalcTB.get_data_info_v2</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function get_data_info(at_set, dim)</code></pre><p>Figure out the arrangement of data in a <code>coefs</code> file.</p><p>Loops over various combinations of orbitals and atoms and assigns them places in <code>datH</code> and <code>datS</code>, depending on the terms included in the model and the dimensionaly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L526-L532">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.laguerre" href="#ThreeBodyTB.CalcTB.laguerre"><code>ThreeBodyTB.CalcTB.laguerre</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function laguerre(dist, ind=missing; nmax=6, memory=missing)</code></pre><p>Calculate laguerre polynomials up to order <code>nmax</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L3917-L3921">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.make_coefs-Tuple{Any,Any}" href="#ThreeBodyTB.CalcTB.make_coefs-Tuple{Any,Any}"><code>ThreeBodyTB.CalcTB.make_coefs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function make_coefs(at_list, dim; datH=missing, datS=missing, cutoff=18.01, min_dist = 3.0, fillzeros=false, maxmin_val_train=missing, dist_frontier=missing)</code></pre><p>Constructor for <code>coefs</code>. Can create coefs filled with ones for testing purposes.</p><p>See <code>coefs</code> to understand arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L265-L271">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.plot_database" href="#ThreeBodyTB.CalcTB.plot_database"><code>ThreeBodyTB.CalcTB.plot_database</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function plot_database(database, entry, t=missing)</code></pre><p>Plot some data from <code>coefs</code>. Needs to be updated to work with Plots, probably doesn&#39;t work now.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L339-L343">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.read_coefs" href="#ThreeBodyTB.CalcTB.read_coefs"><code>ThreeBodyTB.CalcTB.read_coefs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function read_coefs(filename, directory = missing)</code></pre><p>Read <code>coefs</code> from filename. Can read gzip directly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L186-L190">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.renormalize_S" href="#ThreeBodyTB.CalcTB.renormalize_S"><code>ThreeBodyTB.CalcTB.renormalize_S</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function renormalize_S(tbc, database, cutoff=17.99)</code></pre><p>Function for changing S but keeping the band structure fixed. Not currently used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L5046-L5050">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.symmetry_factor-NTuple{4,Any}" href="#ThreeBodyTB.CalcTB.symmetry_factor-NTuple{4,Any}"><code>ThreeBodyTB.CalcTB.symmetry_factor</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function symmetry_factor(s1,s2,lmn, dat)</code></pre><p>All of the spd Slater-Koster matrix elements. <code>dat</code> is preallocated memory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L4298-L4302">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.symmetry_factor_fit-Tuple{Any,Any,Any}" href="#ThreeBodyTB.CalcTB.symmetry_factor_fit-Tuple{Any,Any,Any}"><code>ThreeBodyTB.CalcTB.symmetry_factor_fit</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function symmetry_factor_fit(s1,s2,lmn)</code></pre><p>All the Slater-Koster factors, for fitting.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L4516-L4520">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.three_body_H" href="#ThreeBodyTB.CalcTB.three_body_H"><code>ThreeBodyTB.CalcTB.three_body_H</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function two_body_H(dist, ind=missing)</code></pre><p>get 3body hamiltonian terms together.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L4191-L4195">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.three_body_O" href="#ThreeBodyTB.CalcTB.three_body_O"><code>ThreeBodyTB.CalcTB.three_body_O</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function two_body_O(dist, ind=missing)</code></pre><p>three body onsite.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L4026-L4030">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.trim_dist" href="#ThreeBodyTB.CalcTB.trim_dist"><code>ThreeBodyTB.CalcTB.trim_dist</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function trim_dist(tbc, cutoff=18.0001)</code></pre><p>Reduce the atom-atom hamiltonian terms longer than cutoff.</p><p>Not used in typical code, but can make <code>tbc</code> run faster / reduce memory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L1881-L1887">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.two_body_H" href="#ThreeBodyTB.CalcTB.two_body_H"><code>ThreeBodyTB.CalcTB.two_body_H</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function two_body_H(dist, ind=missing)</code></pre><p>Two body intersite Hamiltonian.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L4165-L4169">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.two_body_O" href="#ThreeBodyTB.CalcTB.two_body_O"><code>ThreeBodyTB.CalcTB.two_body_O</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function two_body_O(dist, ind=missing)</code></pre><p>Two body onsite</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L4013-L4017">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.two_body_S" href="#ThreeBodyTB.CalcTB.two_body_S"><code>ThreeBodyTB.CalcTB.two_body_S</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function two_body_H(dist, ind=missing)</code></pre><p>Two body intersite overlap.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L4178-L4182">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CalcTB.write_coefs-Tuple{Any,ThreeBodyTB.CalcTB.coefs}" href="#ThreeBodyTB.CalcTB.write_coefs-Tuple{Any,ThreeBodyTB.CalcTB.coefs}"><code>ThreeBodyTB.CalcTB.write_coefs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function write_coefs(filename, co::coefs; compress=true)</code></pre><p>Write <code>coefs</code> to a file. Compress uses gzip. See <code>read_coefs</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/CalcTB_laguerre.jl#L133-L137">source</a></section></article><h2 id="CrystalMod"><a class="docs-heading-anchor" href="#CrystalMod">CrystalMod</a><a id="CrystalMod-1"></a><a class="docs-heading-anchor-permalink" href="#CrystalMod" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CrystalMod.parsePOSCAR" href="#ThreeBodyTB.CrystalMod.parsePOSCAR"><code>ThreeBodyTB.CrystalMod.parsePOSCAR</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function parsePOSCAR(lines)</code></pre><p>Parse a POSCAR from VASP</p><p>Called by makecrys, doesn&#39;t need to be called directly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Crystal.jl#L422-L428">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CrystalMod.parseQEinput" href="#ThreeBodyTB.CrystalMod.parseQEinput"><code>ThreeBodyTB.CrystalMod.parseQEinput</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function parseQEinput(lines)</code></pre><p>Parse a quantum espresso inputfile. Can only handle simple cases with explict CELL_PARAMETERS Cannot handle nonzero ibrav. or celldm</p><p>Called by makecrys, doesn&#39;t need to be called directly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Crystal.jl#L489-L496">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CrystalMod.generate_supercell" href="#ThreeBodyTB.CrystalMod.generate_supercell"><code>ThreeBodyTB.CrystalMod.generate_supercell</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function generate_supercell(crys, cell)</code></pre><p>Generate supercell. cell is <code>[1,1,2]</code>, etc. </p><p>Note, perfered notation is to use syntax: <code>c * [1,1,2]</code> , where <code>c</code> is a crystal, thus  using overloading of the <code>*</code> operator,  rather than calling directly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Crystal.jl#L567-L576">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CrystalMod.generate_random_distortion" href="#ThreeBodyTB.CrystalMod.generate_random_distortion"><code>ThreeBodyTB.CrystalMod.generate_random_distortion</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function generate_random_distortion(crys, amag, strain_mag)</code></pre><p>Randomly distort a crystal. <code>amag</code> is the atom distance, <code>strain_mag</code> is the strain magnitude</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Crystal.jl#L614-L618">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CrystalMod.write_poscar" href="#ThreeBodyTB.CrystalMod.write_poscar"><code>ThreeBodyTB.CrystalMod.write_poscar</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function write_poscar(crys, filename)</code></pre><p>Write a <code>crystal</code> to a POSCAR.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Crystal.jl#L634-L638">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CrystalMod.write_efs" href="#ThreeBodyTB.CrystalMod.write_efs"><code>ThreeBodyTB.CrystalMod.write_efs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function function write_efs(crys, energy, forces, stress, filename)</code></pre><p>Write <code>crystal</code>, energy, force, stress to fake quantum espresso output file. This is for testing purposes only.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Crystal.jl#L779-L784">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CrystalMod.get_grid" href="#ThreeBodyTB.CrystalMod.get_grid"><code>ThreeBodyTB.CrystalMod.get_grid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function get_grid(c, kden=55.0)</code></pre><p>Get a default k-point grid size with <code>kden</code> density.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Crystal.jl#L831-L835">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.CrystalMod.orbital_index" href="#ThreeBodyTB.CrystalMod.orbital_index"><code>ThreeBodyTB.CrystalMod.orbital_index</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function orbital_index(c::crystal)</code></pre><p>Get correspondence between <code>crystal</code> and the TB orbital numbers.</p><p><code>return ind2orb, orb2ind, etotal, nval</code></p><ul><li><code>ind2orb</code> dictionary which gives <code>[atom_number,atom_type, :orbital_symbol]</code> from TB index integer.</li><li><code>orb2ind</code> dictionary which gives TB index integer from <code>[atom_number,atom_type, :orbital_symbol]</code></li><li><code>etotal</code> total DFT energy of atoms, for calculation atomization energy.</li><li><code>nval</code> number of valence orbitals.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Crystal.jl#L886-L897">source</a></section></article><h2 id="DFToutMod"><a class="docs-heading-anchor" href="#DFToutMod">DFToutMod</a><a id="DFToutMod-1"></a><a class="docs-heading-anchor-permalink" href="#DFToutMod" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.DFToutMod" href="#ThreeBodyTB.DFToutMod"><code>ThreeBodyTB.DFToutMod</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia">module DFToutMod</code></pre><p>Deal with energy, force, stress, band structure, etc, from a DFT calculation</p><p>Generic to different DFT codes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/DFToutMod.jl#L4-L10">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.DFToutMod.bandstructure" href="#ThreeBodyTB.DFToutMod.bandstructure"><code>ThreeBodyTB.DFToutMod.bandstructure</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">mutable struct bandstructure</code></pre><p>Band structure. Has</p><ul><li><code>nbnd::Int</code> Number of bands</li><li><code>nks::Int</code> Number of k-points</li><li><code>nelec::Float64</code> Number of electrons</li><li><code>efermi::Float64</code> Fermi energy</li><li><code>kpts::Array{Float64,2}</code> List of k-points, <code>nks × 3</code> array in BZ crystal units.</li><li><code>kweights::Array{Float64,1}</code> Weights of k-points (<code>nks</code>).</li><li><code>kgrid::Array{Int,1}</code> Equivalent gamma centered Monkhorst-Pack k-grid dimensions, if applies.</li><li><code>eigs::Array{Float64,2}</code> Eigenvalues. <code>nks × nbnd</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/DFToutMod.jl#L41-L55">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.DFToutMod.dftout" href="#ThreeBodyTB.DFToutMod.dftout"><code>ThreeBodyTB.DFToutMod.dftout</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">mutable struct dftout</code></pre><p>DFT output struct. Has</p><ul><li><code>crys::crystal</code>  crystal structure</li><li><code>energy::Float64</code> the actual DFT energy, depends on pseudopotentials.</li><li><code>energy_smear::Float64</code> smearing energy</li><li><code>forces::Array{Float64,2}</code> forces Ryd / a.u.</li><li><code>stress::Array{Float64,2}</code> stress  Ryd / (a.u.)^3</li><li><code>bandstruct::bandstructure</code> See bandstructure struct</li><li><code>hasband::Bool</code> does this object have a band structure, usually <code>true</code></li><li><code>hasham::Bool</code> not used, always <code>false</code></li><li><code>prefix::String</code>  A string has a name used to find output files.</li><li><code>outdir::String</code> Directly loaded from</li><li><code>tot_charge::Float64</code> If charge of unit cell is nonzero</li><li><code>atomize_energy::Float64</code> Atomization energy, relative to non-spin-polarized atoms.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/DFToutMod.jl#L67-L84">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.DFToutMod.get_atomize_energy-Tuple{dftout}" href="#ThreeBodyTB.DFToutMod.get_atomize_energy-Tuple{dftout}"><code>ThreeBodyTB.DFToutMod.get_atomize_energy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function get_atomize_energy(d::dftout)</code></pre><p>Return atomization energy in current energy units</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/DFToutMod.jl#L102-L106">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.DFToutMod.makebs-Tuple{Number,Number,Any,Any,Any,Any}" href="#ThreeBodyTB.DFToutMod.makebs-Tuple{Number,Number,Any,Any,Any,Any}"><code>ThreeBodyTB.DFToutMod.makebs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function makebs(nelec::Number, efermi::Number,  kpoints, kweights,kgrid, vals)</code></pre><p>Constructor for <code>bandstructure</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/DFToutMod.jl#L181-L185">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.DFToutMod.makedftout" href="#ThreeBodyTB.DFToutMod.makedftout"><code>ThreeBodyTB.DFToutMod.makedftout</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function makedftout(crys::crystal, energy::Number, energy_smear::Number,  forces, stress, bandstruct=missing; prefix=&quot;PREFIX&quot;, outdir=&quot;TMPDIR&quot;, tot_charge=0.0)</code></pre><p>Constructor for dftout. Usually called by function that loads DFT output files, not called directly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/DFToutMod.jl#L217-L221">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.DFToutMod.makedftout" href="#ThreeBodyTB.DFToutMod.makedftout"><code>ThreeBodyTB.DFToutMod.makedftout</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function makedftout(A, pos, types, energy::Number,energy_smear::Number,  forces, stress, bandstruct=missing; prefix=&quot;PREFIX&quot;, outdir=&quot;TMPDIR&quot;, tot_charge=0.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/DFToutMod.jl#L263-L265">source</a></section></article><h2 id="DFT"><a class="docs-heading-anchor" href="#DFT">DFT</a><a id="DFT-1"></a><a class="docs-heading-anchor-permalink" href="#DFT" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.DFT" href="#ThreeBodyTB.DFT"><code>ThreeBodyTB.DFT</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia">module DFT</code></pre><p>This is the generic DFT interface. Only QE is currently implemented however.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/RunDFT.jl#L626-L630">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.DFT.runSCF-Tuple{ThreeBodyTB.CrystalMod.crystal}" href="#ThreeBodyTB.DFT.runSCF-Tuple{ThreeBodyTB.CrystalMod.crystal}"><code>ThreeBodyTB.DFT.runSCF</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function runSCF(crys::crystal; inputstr=missing, prefix=missing, tmpdir=&quot;./&quot;, directory=&quot;./&quot;, functional=&quot;PBESOL&quot;, wannier=0, nprocs=1, code=&quot;QE&quot;, skip=false, calculation=&quot;scf&quot;, dofree=&quot;all&quot;, tot_charge = 0.0, smearing = missing, magnetic=false, cleanup=false, use_backup=false)</code></pre><p>Workflow for generic DFT SCF calculation. <code>code</code> can only by &quot;QE&quot;</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/RunDFT.jl#L643-L647">source</a></section></article><h2 id="QE"><a class="docs-heading-anchor" href="#QE">QE</a><a id="QE-1"></a><a class="docs-heading-anchor-permalink" href="#QE" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.QE" href="#ThreeBodyTB.QE"><code>ThreeBodyTB.QE</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia">module QE</code></pre><p>Module for running Quantum Espresso. Generic DFT version below.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/RunDFT.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.QE.doclean-Tuple{Any}" href="#ThreeBodyTB.QE.doclean-Tuple{Any}"><code>ThreeBodyTB.QE.doclean</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function doclean(d)</code></pre><p>Clean up wavefunctions in directory <code>d</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/RunDFT.jl#L197-L201">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.QE.loadXML-Tuple{Any}" href="#ThreeBodyTB.QE.loadXML-Tuple{Any}"><code>ThreeBodyTB.QE.loadXML</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function loadXML(savedir)</code></pre><p>Load a QE SCF DFT calculation into a <code>dftout</code> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/RunDFT.jl#L451-L455">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.QE.loadXML_bs-Tuple{Any}" href="#ThreeBodyTB.QE.loadXML_bs-Tuple{Any}"><code>ThreeBodyTB.QE.loadXML_bs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function loadXML_bs(savedir::String)</code></pre><p>Load <code>bandstructure</code> from QE xml file that was converted to a dict already</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/RunDFT.jl#L571-L575">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.QE.loadXML_bs-Tuple{String}" href="#ThreeBodyTB.QE.loadXML_bs-Tuple{String}"><code>ThreeBodyTB.QE.loadXML_bs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function loadXML_bs(savedir::String)</code></pre><p>Load <code>bandstructure</code> from QE xml file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/RunDFT.jl#L557-L561">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.QE.makeSCF" href="#ThreeBodyTB.QE.makeSCF"><code>ThreeBodyTB.QE.makeSCF</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function makeSCF(crys::crystal, directory=&quot;./&quot;, prefix=missing, tmpdir=missing, functional=&quot;PBESOL&quot;, wannier=0, calculation=&quot;scf&quot;, dofree=&quot;all&quot;, tot_charge = 0.0, smearing = 0.01, magnetic=false; mixing=&quot;local-TF&quot;)</code></pre><p>Make QE inputfile for SCF DFT calculation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/RunDFT.jl#L223-L227">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.QE.make_commands" href="#ThreeBodyTB.QE.make_commands"><code>ThreeBodyTB.QE.make_commands</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function make_commands(nprocs=1)</code></pre><p>Returns a dictionary with command lines to call external programs on the command line nprocs is the number of processors for parallel execution Needs to be changed for you specfic program locations  and mpi commands (if any)</p><p>This needs to be edited to actually run QE yourself. Running wannier90 is optional, not part of current code.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Commands.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.QE.makedict-Tuple{Any}" href="#ThreeBodyTB.QE.makedict-Tuple{Any}"><code>ThreeBodyTB.QE.makedict</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function makedict(savedir)</p><p>Load a data-file-schema.xml as julia dictionary.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/RunDFT.jl#L424-L428">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.QE.runSCF" href="#ThreeBodyTB.QE.runSCF"><code>ThreeBodyTB.QE.runSCF</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function runSCF(crys::crystal, inputstr=missing, prefix=missing, tmpdir=&quot;./&quot;, directory=&quot;./&quot;, functional=&quot;PBESOL&quot;, wannier=0, nprocs=1, skip=false, calculation=&quot;scf&quot;, dofree=&quot;all&quot;, tot_charge = 0.0, smearing = 0.01, magnetic=false, cleanup=false, use_backup=false)</code></pre><p>Workflow for doing SCF DFT calculation on <code>crys</code></p><p>Return <code>dftout</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/RunDFT.jl#L84-L90">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.QE.run_pwscf" href="#ThreeBodyTB.QE.run_pwscf"><code>ThreeBodyTB.QE.run_pwscf</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function run_pwscf(inputstr, outputstr, nprocs=1, directory=&quot;./&quot;, use_backup=false)</code></pre><p>Run the pw.x code from QE on <code>inputstr</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/RunDFT.jl#L38-L42">source</a></section></article><h2 id="Ewald"><a class="docs-heading-anchor" href="#Ewald">Ewald</a><a id="Ewald-1"></a><a class="docs-heading-anchor-permalink" href="#Ewald" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Ewald" href="#ThreeBodyTB.Ewald"><code>ThreeBodyTB.Ewald</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia">module Ewald</code></pre><p>Module for electrostatic preperation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Ewald.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Ewald.electrostatics_getgamma-Tuple{ThreeBodyTB.CrystalMod.crystal}" href="#ThreeBodyTB.Ewald.electrostatics_getgamma-Tuple{ThreeBodyTB.CrystalMod.crystal}"><code>ThreeBodyTB.Ewald.electrostatics_getgamma</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function electrostatics_getgamma(crys::crystal;  kappa=missing, noU=false, onlyU=false, screening = 1.0)</code></pre><p>Main function. Does Ewald calculation on <code>crys</code>. Returns <code>gamma</code>, which is used in scf calculation. This is only run once for a given <code>tb_crys</code> object and stored.</p><ul><li><code>kappa</code> is the splitting parameter between real/k-space in Ewald calculation. Will estimate best one if not provided.</li><li><code>noU=false</code> for testing only</li><li><code>onlyU=false</code> for testing only</li><li><code>screening=1.0</code> Not used. Purpose is to reduce U values for values &lt; 1.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Ewald.jl#L64-L74">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Ewald.estimate_best_kappa-Tuple{Any}" href="#ThreeBodyTB.Ewald.estimate_best_kappa-Tuple{Any}"><code>ThreeBodyTB.Ewald.estimate_best_kappa</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function estimate_best_kappa(A)</code></pre><p>Estimate best value of <code>kappa</code> for Ewald sum. Shouldn&#39;t effect final value, only calculation speed. There is probably a better way to do this.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Ewald.jl#L328-L334">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Ewald.getU-Tuple{Any}" href="#ThreeBodyTB.Ewald.getU-Tuple{Any}"><code>ThreeBodyTB.Ewald.getU</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function getU(types)</p><p>Get values of <code>U</code> from <code>Atomdata</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Ewald.jl#L30-L34">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Ewald.get_onsite-Tuple{ThreeBodyTB.CrystalMod.crystal,Array{Float64,1}}" href="#ThreeBodyTB.Ewald.get_onsite-Tuple{ThreeBodyTB.CrystalMod.crystal,Array{Float64,1}}"><code>ThreeBodyTB.Ewald.get_onsite</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function get_onsite(crys::crystal, U::Array{Float64,1})</code></pre><p>return Onsite terms, Coulumb <code>U</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Ewald.jl#L46-L50">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Ewald.k_space" href="#ThreeBodyTB.Ewald.k_space"><code>ThreeBodyTB.Ewald.k_space</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function k_space(crys::crystal, kappa, starting_size_kspace=2)</code></pre><p>K-space Ewald sum.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Ewald.jl#L377-L381">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Ewald.real_space" href="#ThreeBodyTB.Ewald.real_space"><code>ThreeBodyTB.Ewald.real_space</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function real_space(crys::crystal, kappa::Float64, U::Array{Float64}, starting_size_rspace=2)</code></pre><p>Real-space Ewald sum.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Ewald.jl#L166-L170">source</a></section></article><h2 id="FitTB"><a class="docs-heading-anchor" href="#FitTB">FitTB</a><a id="FitTB-1"></a><a class="docs-heading-anchor-permalink" href="#FitTB" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.FitTB.do_fitting-Tuple{Any}" href="#ThreeBodyTB.FitTB.do_fitting-Tuple{Any}"><code>ThreeBodyTB.FitTB.do_fitting</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function do_fitting(list_of_tbcs; kpoints = missing,  atoms_to_fit=missing, fit_threebody=true, fit_threebody_onsite=true, do_plot = true)</code></pre><p>Used for simple linear fitting of coefficients. Interface for more complicated fitting.</p><ul><li><code>list_of_tbcs</code> - List of <code>tbc_crys</code> or tbc<em>crys</em>k` objects to fit to.</li><li><code>dft_list</code> - for kspace fitting, use </li><li><code>fit_threebody=true</code> - Fit threebody coefficients. Sometimes <code>false</code> for testing, but <code>true</code> for production.</li><li><code>fit_threebody_onsite=true</code> - Fit threebody onsite coefficients. See above.</li><li><code>do_plot=true</code> - show simple plot comparing coefficients to tbc reference.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/FitTB_laguerre.jl#L77-L87">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.FitTB.do_fitting_linear-Tuple{Any}" href="#ThreeBodyTB.FitTB.do_fitting_linear-Tuple{Any}"><code>ThreeBodyTB.FitTB.do_fitting_linear</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function do_fitting_linear(list_of_tbcs; kpoints = missing, dft_list = missing,  fit_threebody=true, fit_threebody_onsite=true, do_plot = true, starting_database=missing, mode=:kspace, return_database=true, NLIM=100, refit_database=missing)</code></pre><p>Linear fitting (not recursive). Used as starting point of recursive fitting.</p><p><strong>Arguments.</strong></p><ul><li><code>list_of_tbcs</code> The main data to fit to. Consists of a list of <code>tb_crys</code> or <code>tb_crys_kspace</code> objects.</li><li><code>kpoints = missing</code> Kpoints to do fitting to in k-space. Usually, this is not used, see below.</li><li><code>dft_list = missing</code> List of <code>dftout</code> objects. Normally, we get symmetry reduced k-grids from these objects.</li><li><code>fit_threebody=true</code> Fit three body coefficients. Yes for production runs.</li><li><code>fit_threebody_onsite=true</code> Fit 3body onsite coefficients. Yes for production runs.</li><li><code>do_plot = true</code> Make a plot to assess fitting. </li><li><code>starting_database=missing</code> Use a database dict with some of the coefficents already fit and fixed.</li><li><code>mode=:kspace</code> Fit in either <code>:kspace</code> or <code>:rspace</code>. Can only use r-space if using only <code>tbc_crys</code> real-space objects to fit to. <code>:kspace</code> is normal.</li><li><code>return_database=true</code> Return the final database. For use when called by other functions.</li><li><code>NLIM=100</code> Largest number of k-points per structure. Set to smaller numbers to make code go faster / reduce memory, but may be less accurate.</li><li><code>refit_database=missing</code> starting point for coefficients we are fitting. Usually not used, as it doesn&#39;t always speed things up in practice. Something may not work about this option.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/FitTB_laguerre.jl#L583-L601">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.FitTB.do_fitting_recursive-Tuple{Any}" href="#ThreeBodyTB.FitTB.do_fitting_recursive-Tuple{Any}"><code>ThreeBodyTB.FitTB.do_fitting_recursive</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function do_fitting_recursive(list_of_tbcs ; weights_list = missing, dft_list=missing, X_cv = missing, kpoints = [0 0 0; 0 0 0.5; 0 0.5 0.5; 0.5 0.5 0.5], starting_database = missing,  update_all = false, fit_threebody=true, fit_threebody_onsite=true, do_plot = false, energy_weight = missing, rs_weight=missing,ks_weight=missing, niters=50, lambda=0.0, leave_one_out=false, prepare_data = missing, RW_PARAM=0.0, NLIM = 100, refit_database = missing, start_small = false)</code></pre><p>This is the primary function for fitting. Uses the self-consistent linear fitting algorithm.</p><p><strong>Arguments</strong></p><ul><li><code>list_of_tbcs</code> List of <code>tbc_crys</code> or <code>tbc_crys_kspace</code> object to fit to.</li><li><code>weights_list = missing</code> relative weights of different tbc objects in fitting code.</li><li><code>dft_list=missing</code> List of <code>dftout</code> objects used to get symmetry-reduced kpoint lists / weights to use in kspace fitting.</li><li><code>kpoints = [0 0 0; 0 0 0.5; 0 0.5 0.5; 0.5 0.5 0.5]</code> alternate way of setting k-points, not usually used.</li><li><code>starting_database = missing</code> If using already fit coefficents for some of the atoms, from another calculation, include that database dict here.</li><li><code>update_all = false</code> If update<em>all is true, then we refit the starting coefficients from `starting</em>database<code>. Normally</code>false` except for testing.</li><li><code>fit_threebody=true</code> Fit 3body intersite coefficents. <code>true</code> for production runs.</li><li><code>fit_threebody_onsite=true</code> Fit 3body onsite coefficents. <code>true</code> for production runs.</li><li><code>do_plot = false</code> make plot for the linear fit.</li><li><code>energy_weight = missing</code> Weighting for the total energy terms in the fit.</li><li><code>rs_weight=missing</code> Real space hamiltonian matrix els weighting. zero for pure k-space fit.</li><li><code>ks_weight=missing</code>  K-space hamiltonian matrix els weighting. Set to zero to ignore hamiltonian matrix els and only fit to band structure.</li><li><code>niters=50</code> Maximum number of iterations.</li><li><code>lambda=0.0</code>  If greater than zero, include a simple ridge regression with this lambda value. Usually zero.</li><li><code>leave_one_out=false</code>  Leave-one-out cross-validation. Too slow to be very useful.</li><li><code>prepare_data = missing</code> Rarely used option to reuse previous linear fitting.</li><li><code>RW_PARAM=0.0</code> Weighting of non-occupied bands in fit.</li><li><code>NLIM = 100</code> Maximum k-points per structure. Smaller for faster but less accurate fit that uses less memory.</li><li><code>refit_database = missing</code> Option to include starting data. Rarely used.</li><li><code>start_small = false</code> When fitting only 3body data, setting this to true will start the 3body terms with very small values, which can improve convergence. Not useful if also fitting 2body terms.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/FitTB_laguerre.jl#L1701-L1728">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.FitTB.extract_database-NTuple{6,Any}" href="#ThreeBodyTB.FitTB.extract_database-NTuple{6,Any}"><code>ThreeBodyTB.FitTB.extract_database</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function extract_database(database_old,nh,ns, KEYS, HIND, SIND)</code></pre><p>If we are using fixed prefit coefficients, we have to get them in the same form as our current fitting.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/FitTB_laguerre.jl#L1098-L1102">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.FitTB.fourierspace-NTuple{13,Any}" href="#ThreeBodyTB.FitTB.fourierspace-NTuple{13,Any}"><code>ThreeBodyTB.FitTB.fourierspace</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function fourierspace(tbc, kpoints, X_H, X_S, Y_H, Y_S, Xhc, Xsc, rind, Rvec, INDVec, h_on, ind_convert)</code></pre><p>Do analytic fourier transform of real space fitting matrices into kspace.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/FitTB_laguerre.jl#L1154-L1158">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.FitTB.get_k-Tuple{Any,Any,Any}" href="#ThreeBodyTB.FitTB.get_k-Tuple{Any,Any,Any}"><code>ThreeBodyTB.FitTB.get_k</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function get_k(dft_list, ncalc; NLIM = 100)</code></pre><p>Decide which k-points to include in fitting, as we limit the total number to <code>NLIM</code> or less per structure</p><p>Uses some randomness, but puts high symmetry points at front of line.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/FitTB_laguerre.jl#L1597-L1603">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.FitTB.hermetian_index-Tuple{Int64,Int64,Int64}" href="#ThreeBodyTB.FitTB.hermetian_index-Tuple{Int64,Int64,Int64}"><code>ThreeBodyTB.FitTB.hermetian_index</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function hermetian_index(i::Int64,j::Int64,nwan::Int64)</code></pre><p>This is used to reduce memory by only keeping track of independet coefficients of Hermetian matrices, which is nearly a factor of 2 reduction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/FitTB_laguerre.jl#L1582-L1586">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.FitTB.make_database-NTuple{7,Any}" href="#ThreeBodyTB.FitTB.make_database-NTuple{7,Any}"><code>ThreeBodyTB.FitTB.make_database</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function make_database(ch, cs,  KEYS, HIND, SIND, DMIN_TYPES, DMIN_TYPES3; scf=false, starting_database=missing, tbc_list=missing)</code></pre><p>Construct the <code>coefs</code> and database from final results of fitting.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/FitTB_laguerre.jl#L946-L950">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.FitTB.prepare_for_fitting-Tuple{Any}" href="#ThreeBodyTB.FitTB.prepare_for_fitting-Tuple{Any}"><code>ThreeBodyTB.FitTB.prepare_for_fitting</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function prepare_for_fitting(list_of_tbcs; kpoints = missing, dft_list = missing, fit_threebody=false, fit_threebody_onsite=false, starting_database=missing, refit_database=missing)</code></pre><p>Make lots of preperations for fitting. Moves things around, put stuff in materices, etc.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/FitTB_laguerre.jl#L95-L99">source</a></section></article><h2 id="Force_Stress"><a class="docs-heading-anchor" href="#Force_Stress">Force_Stress</a><a id="Force_Stress-1"></a><a class="docs-heading-anchor-permalink" href="#Force_Stress" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Force_Stress" href="#ThreeBodyTB.Force_Stress"><code>ThreeBodyTB.Force_Stress</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia">module Force_Stress</code></pre><p>Module for calculating force and stress</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Force_Stress.jl#L7-L11">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Force_Stress.finite_diff-Tuple{ThreeBodyTB.CrystalMod.crystal,Any,Any,Any}" href="#ThreeBodyTB.Force_Stress.finite_diff-Tuple{ThreeBodyTB.CrystalMod.crystal,Any,Any,Any}"><code>ThreeBodyTB.Force_Stress.finite_diff</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function finite_diff(crys::crystal, database, ind1, ind2; stress_mode=false, step = 0.0002, smearing = 0.01, grid = missing)</code></pre><p>Finite differences force/stress, for testing.</p><p><strong>Arguments</strong></p><ul><li><code>crys::crystal</code> Crystal structure</li><li><code>database</code> Database of fitting coefficents.</li><li><code>ind1</code>  atom index for first stress index</li><li><code>ind2</code> cartesian index or second stress index</li><li><code>stress_mode=false</code> true for stress, otherwise force.</li><li><code>step = 0.0002</code> step_size for finite steps.</li><li><code>smearing = 0.01</code> smearing energy</li><li><code>grid = missing</code> kpoint grid</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Force_Stress.jl#L295-L308">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Force_Stress.get_energy_force_stress-Tuple{ThreeBodyTB.CrystalMod.crystal,Any}" href="#ThreeBodyTB.Force_Stress.get_energy_force_stress-Tuple{ThreeBodyTB.CrystalMod.crystal,Any}"><code>ThreeBodyTB.Force_Stress.get_energy_force_stress</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function get_energy_force_stress(crys::crystal, database; smearing = 0.01, grid = missing)</code></pre><p>Get force and stress, non-fft algorithm. Generally use the fft algorithm.</p><p><code>return energy_tot,  f_cart, stress</code></p><p>Returns Ryd units. Generally users should use the <code>scf_energy_force_stress</code> function</p><p>Uses automatic differentation for gradient.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Force_Stress.jl#L53-L63">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Force_Stress.get_energy_force_stress-Tuple{ThreeBodyTB.TB.tb_crys,Any}" href="#ThreeBodyTB.Force_Stress.get_energy_force_stress-Tuple{ThreeBodyTB.TB.tb_crys,Any}"><code>ThreeBodyTB.Force_Stress.get_energy_force_stress</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function get_energy_force_stress(crys::crystal, database; smearing = 0.01, grid = missing)</code></pre><p>Get force and stress, non-fft algorithm</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Force_Stress.jl#L72-L76">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Force_Stress.get_energy_force_stress_fft-Tuple{ThreeBodyTB.TB.tb_crys,Any}" href="#ThreeBodyTB.Force_Stress.get_energy_force_stress_fft-Tuple{ThreeBodyTB.TB.tb_crys,Any}"><code>ThreeBodyTB.Force_Stress.get_energy_force_stress_fft</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function get_energy_force_stress_fft(tbc::tb_crys, database; do_scf=false, smearing = 0.01, grid = missing, e_den0=missing, vv = missing)</code></pre><p>Calculate energy/force/stress using fft algorithm. Users should use <code>scf_energy_force_stress</code>, which calls this. Uses automatic differentation for jacobian.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Force_Stress.jl#L936-L940">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Force_Stress.inv_reshape_vec-Tuple{Any,Any,Any}" href="#ThreeBodyTB.Force_Stress.inv_reshape_vec-Tuple{Any,Any,Any}"><code>ThreeBodyTB.Force_Stress.inv_reshape_vec</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function inv_reshape_vec(x, strain, nat; strain_mode=true)</code></pre><p>The force and relax algorithms from outside codes take in vectors, not <code>crystal</code> &#39;s. So we have to reshape vectors to and from <code>crystals</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Force_Stress.jl#L832-L837">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Force_Stress.psi_gradH_psi-NTuple{11,Any}" href="#ThreeBodyTB.Force_Stress.psi_gradH_psi-NTuple{11,Any}"><code>ThreeBodyTB.Force_Stress.psi_gradH_psi</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function psi_gradH_psi(VALS0, VECTS, hk_g, sk_g, h1, VALS, scf, nwan, nat, grid, OCCS)</code></pre><p>Helper function for &lt;psi | grad_Ham | psi &gt;</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Force_Stress.jl#L1272-L1276">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Force_Stress.psi_gradH_psi2-NTuple{11,Any}" href="#ThreeBodyTB.Force_Stress.psi_gradH_psi2-NTuple{11,Any}"><code>ThreeBodyTB.Force_Stress.psi_gradH_psi2</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function psi_gradH_psi(VALS0, VECTS, hk_g, sk_g, h1, VALS, scf, nwan, nat, grid, OCCS)</code></pre><p>Helper function for &lt;psi | grad_Ham | psi &gt;</p><p>This version isn&#39;t used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Force_Stress.jl#L1320-L1326">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Force_Stress.reshape_vec-Tuple{Any,Any}" href="#ThreeBodyTB.Force_Stress.reshape_vec-Tuple{Any,Any}"><code>ThreeBodyTB.Force_Stress.reshape_vec</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function reshape_vec(x, nat; strain_mode=false)</code></pre><p>The force and relax algorithms from outside codes take in vectors, not <code>crystal</code> &#39;s. So we have to reshape vectors to and from <code>crystals</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Force_Stress.jl#L767-L772">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Force_Stress.safe_mode_energy-Tuple{ThreeBodyTB.CrystalMod.crystal,Any}" href="#ThreeBodyTB.Force_Stress.safe_mode_energy-Tuple{ThreeBodyTB.CrystalMod.crystal,Any}"><code>ThreeBodyTB.Force_Stress.safe_mode_energy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function safe_mode_energy(crys::crystal, database; var_type=Float64)</code></pre><p>Relaxation can accidently lead to very small atom-atom distances during the relaxation precedure if too large of step is taken. This function is a repulsive energy function at short range to make sure the relaxtion doesn&#39;t get stuck at very short distances where the fitting doesn&#39;t apply.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Force_Stress.jl#L873-L879">source</a></section></article><h2 id="ManageDatabase"><a class="docs-heading-anchor" href="#ManageDatabase">ManageDatabase</a><a id="ManageDatabase-1"></a><a class="docs-heading-anchor-permalink" href="#ManageDatabase" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.ManageDatabase" href="#ThreeBodyTB.ManageDatabase"><code>ThreeBodyTB.ManageDatabase</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia">module ManageDatabase</code></pre><p>Module for reading <code>coefs</code> from files and making database as needed for calculations</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/ManageDatabase.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.ManageDatabase.add_to_database-Tuple{Set}" href="#ThreeBodyTB.ManageDatabase.add_to_database-Tuple{Set}"><code>ThreeBodyTB.ManageDatabase.add_to_database</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function add_to_database(s::Set)</code></pre><p>Load elements or twobody terms from precalcuated <code>coefs</code> from files.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/ManageDatabase.jl#L80-L84">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.ManageDatabase.clear_database-Tuple{}" href="#ThreeBodyTB.ManageDatabase.clear_database-Tuple{}"><code>ThreeBodyTB.ManageDatabase.clear_database</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function clear_database()</code></pre><p>Remove loaded databasea</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/ManageDatabase.jl#L37-L41">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.ManageDatabase.prepare_database-Tuple{Any}" href="#ThreeBodyTB.ManageDatabase.prepare_database-Tuple{Any}"><code>ThreeBodyTB.ManageDatabase.prepare_database</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function prepare_database(at_list)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/ManageDatabase.jl#L60-L62">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.ManageDatabase.prepare_database-Tuple{ThreeBodyTB.CrystalMod.crystal}" href="#ThreeBodyTB.ManageDatabase.prepare_database-Tuple{ThreeBodyTB.CrystalMod.crystal}"><code>ThreeBodyTB.ManageDatabase.prepare_database</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function prepare_database(c::crystal)</code></pre><p>Get ready database of precalculated <code>coefs</code> for <code>crystal</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/ManageDatabase.jl#L27-L31">source</a></section></article><h2 id="SCF"><a class="docs-heading-anchor" href="#SCF">SCF</a><a id="SCF-1"></a><a class="docs-heading-anchor-permalink" href="#SCF" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.SCF" href="#ThreeBodyTB.SCF"><code>ThreeBodyTB.SCF</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia">module SCF</code></pre><p>Module for self-consistent field calculations for TB objects.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/SCF.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.SCF.remove_scf_from_tbc-Tuple{Any,Any,Any}" href="#ThreeBodyTB.SCF.remove_scf_from_tbc-Tuple{Any,Any,Any}"><code>ThreeBodyTB.SCF.remove_scf_from_tbc</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function remove_scf_from_tbc(hk3, sk3, tbc; smearing=0.01, e_den = missing)</code></pre><p>This function takes a hk3, sk3 set of hamiltonian / overlap that does not require scf and adjusts it  so that it does require scf, but gives the same energy and band structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/SCF.jl#L747-L752">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.SCF.remove_scf_from_tbc-Tuple{ThreeBodyTB.TB.tb_crys_kspace}" href="#ThreeBodyTB.SCF.remove_scf_from_tbc-Tuple{ThreeBodyTB.TB.tb_crys_kspace}"><code>ThreeBodyTB.SCF.remove_scf_from_tbc</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function remove_scf_from_tbc(tbcK::tb_crys_kspace; smearing=0.01, e_den = missing)</code></pre><p>This function takes a <code>tbc_crys_kspace</code> object that does not require scf and adjusts it  so that it does require scf, but gives the same energy and band structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/SCF.jl#L619-L624">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.SCF.remove_scf_from_tbc-Tuple{ThreeBodyTB.TB.tb_crys}" href="#ThreeBodyTB.SCF.remove_scf_from_tbc-Tuple{ThreeBodyTB.TB.tb_crys}"><code>ThreeBodyTB.SCF.remove_scf_from_tbc</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function remove_scf_from_tbc(tbc::tb_crys; smearing=0.01, grid = missing, e_den = missing)</code></pre><p>This function takes a <code>tbc_crys</code> object that does not require scf and adjusts it  so that it does require scf, but gives the same energy and band structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/SCF.jl#L708-L713">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.SCF.scf_energy-Tuple{ThreeBodyTB.CrystalMod.crystal,Dict}" href="#ThreeBodyTB.SCF.scf_energy-Tuple{ThreeBodyTB.CrystalMod.crystal,Dict}"><code>ThreeBodyTB.SCF.scf_energy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function scf_energy(c::crystal, database::Dict; smearing=0.01, grid = missing, conv_thr = 1e-5, iters = 75, mix = -1.0, mixing_mode=:pulay, verbose=true)</code></pre><p>Run scf calculation of <code>c::crystal</code>, using <code>database</code> of <code>coefs</code>. The main user version is <code>scf_energy</code> in ThreeBodyTB, which calls this one.</p><ul><li><code>smearing</code> is smearing energy in Ryd.</li><li><code>grid</code> is k-point grid (gamma centered MP), will use default.</li><li><code>conv_thr</code> convergence threshold in Ryd.</li><li><code>iters</code> maximum iterations for first attempt</li><li><code>mix=-1.0</code> default is choose mixing for you. Otherwise, set between <code>0.0</code> and <code>1.0</code></li><li><code>mixing_mode=:pulay</code> default using Pulay mixing (DIIS). Any other input uses simple mixing.</li><li><code>verbose=true</code> verbosity level.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/SCF.jl#L51-L64">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.SCF.scf_energy-Tuple{ThreeBodyTB.TB.tb_crys}" href="#ThreeBodyTB.SCF.scf_energy-Tuple{ThreeBodyTB.TB.tb_crys}"><code>ThreeBodyTB.SCF.scf_energy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function scf_energy(tbc::tb_crys; smearing=0.01, grid = missing, e_den0 = missing, conv_thr = 1e-5, iters = 75, mix = -1.0, mixing_mode=:pulay, verbose=true)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/SCF.jl#L72-L74">source</a></section></article><h2 id="Utilty"><a class="docs-heading-anchor" href="#Utilty">Utilty</a><a id="Utilty-1"></a><a class="docs-heading-anchor-permalink" href="#Utilty" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ThreeBodyTB.Utility" href="#ThreeBodyTB.Utility"><code>ThreeBodyTB.Utility</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia">module Utility</code></pre><p>Some useful functions, mostly for converting stuff and loading files.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kfgarrity/ThreeBodyTB.jl/blob/09460ca0fd182c614160aa81a0e4342e481b7c0e/src/Utility.jl#L1-L5">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../core/">« Functions</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 28 May 2021 13:30">Friday 28 May 2021</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
